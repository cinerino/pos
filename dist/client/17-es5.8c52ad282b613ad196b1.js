!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{AL2A:function(r,n,i){"use strict";i.r(n),i.d(n,"SettingModule",(function(){return S}));var o=i("2kYt"),a=i("DSWM"),c=i("sEIs"),s=i("RRjC"),l=i("sN6X"),p=i("x8Mb"),u=i("PIN6"),d=i("cHUu"),v=i("mOXJ"),h=i("EM62"),f=i("s2Ay"),m=i("+Lug"),g=i("uWtv"),b=i("6WEN"),y=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{s(n.next(e))}catch(t){o(t)}}function c(e){try{s(n.throw(e))}catch(t){o(t)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,c)}s((n=n.apply(e,t||[])).next())}))};function w(e,t){if(1&e){var r=h.Qc();h.Pc(0,"app-input-app",12),h.Wc("valueChanges",(function(e){return h.rd(r),h.Yc().appForm=e})),h.Oc()}if(2&e){var n=h.Yc();h.ed("theaters",n.theaters)("data",null==n.inputData?null:n.inputData.app)}}function F(e,t){if(1&e){var r=h.Qc();h.Pc(0,"app-input-device",13),h.Wc("valueChanges",(function(e){return h.rd(r),h.Yc().deviceForm=e}))("print",(function(){return h.rd(r),h.Yc().print()}))("drawer",(function(){return h.rd(r),h.Yc().openDrawer()})),h.Oc()}if(2&e){var n=h.Yc();h.ed("data",null==n.inputData?null:n.inputData.device)}}function O(e,t){if(1&e){var r=h.Qc();h.Pc(0,"app-input-customer",14),h.Wc("valueChanges",(function(e){return h.rd(r),h.Yc().profileForm=e})),h.Zc(1,"async"),h.Oc()}if(2&e){var n,i=h.Yc(),o=null==(n=h.ad(1,2,i.user))?null:n.language;h.ed("profile",i.inputData.profile)("language",o)}}var k=function(){function r(t,n,i,o,a,c){e(this,r),this.store=t,this.utilService=n,this.actionService=i,this.masterService=o,this.translate=a,this.router=c,this.viewType=p.b.Util.ViewType,this.environment=Object(u.a)()}var n,i,o;return n=r,(i=[{key:"ngOnInit",value:function(){return y(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r,n,i,o,a,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.user=this.store.pipe(Object(l.m)(v.i)),this.error=this.store.pipe(Object(l.m)(v.b)),this.isLoading=this.store.pipe(Object(l.m)(v.c)),this.theaters=[],e.prev=1,e.next=4,this.masterService.searchMovieTheaters();case 4:return this.theaters=e.sent,e.next=7,this.actionService.user.getData();case 7:t=e.sent,r=t.theater,n=t.entranceGate,i=t.pos,o=t.printer,a=t.drawer,c=t.customerContact,this.inputData={app:{theater:r,entranceGate:n,pos:i},device:{printerType:null==o?void 0:o.connectionType,printerIpAddress:null==o?void 0:o.ipAddress,drawer:void 0!==a&&a?"1":"0"},profile:c},e.next=20;break;case 17:e.prev=17,e.t0=e.catch(1),console.error(e.t0),this.router.navigate(["/error"]);case 20:case"end":return e.stop()}}),e,this,[[1,17]])})))}},{key:"onSubmit",value:function(){return y(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r,n,i,o,a,c,s=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object.keys(this.appForm.controls).forEach((function(e){s.appForm.controls[e].markAsTouched()})),Object.keys(this.deviceForm.controls).forEach((function(e){s.deviceForm.controls[e].markAsTouched()})),Object.keys(this.profileForm.controls).forEach((function(e){s.profileForm.controls[e].markAsTouched()})),!(this.appForm.invalid||this.deviceForm.invalid||this.profileForm.invalid)){e.next=4;break}this.utilService.openAlert({title:this.translate.instant("common.error"),body:this.translate.instant("setting.alert.validation")}),e.next=15;break;case 4:if(e.prev=4,t=this.appForm.controls.theaterId.value,r=this.appForm.controls.posId.value,n=this.appForm.controls.entranceGateId.value,void 0!==(i=this.theaters.find((function(e){return e.id===t})))){e.next=8;break}throw new Error("theater not found");case 8:o=void 0===i.hasPOS?void 0:i.hasPOS.find((function(e){return e.id===r})),a=void 0===i.hasEntranceGate?void 0:i.hasEntranceGate.find((function(e){return e.identifier===n})),c=[],Object.keys(this.profileForm.controls).forEach((function(e){/additionalProperty/.test(e)&&c.push({name:e.replace("additionalProperty.",""),value:s.profileForm.controls[e].value})})),this.actionService.user.updateAll({theater:i,pos:o,entranceGate:a,customerContact:{familyName:void 0===this.profileForm.controls.familyName?void 0:this.profileForm.controls.familyName.value,givenName:void 0===this.profileForm.controls.givenName?void 0:this.profileForm.controls.givenName.value,email:void 0===this.profileForm.controls.email?void 0:this.profileForm.controls.email.value,telephone:void 0===this.profileForm.controls.telephone?void 0:this.profileForm.controls.telephone.value.e164Number,age:void 0===this.profileForm.controls.age?void 0:this.profileForm.controls.age.value,address:void 0===this.profileForm.controls.address?void 0:this.profileForm.controls.address.value,gender:void 0===this.profileForm.controls.gender?void 0:this.profileForm.controls.gender.value,additionalProperty:c},printer:{ipAddress:this.deviceForm.controls.printerIpAddress.value,connectionType:this.deviceForm.controls.printerType.value},drawer:"0"!==this.deviceForm.controls.drawer.value}),this.utilService.openAlert({title:this.translate.instant("common.complete"),body:this.translate.instant("setting.alert.success")}),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(4),console.error(e.t0),this.utilService.openAlert({title:this.translate.instant("common.error"),body:"",error:"{}"===JSON.stringify(e.t0)?e.t0:JSON.stringify(e.t0)});case 15:case"end":return e.stop()}}),e,this,[[4,12]])})))}},{key:"print",value:function(){return y(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={connectionType:this.deviceForm.controls.printerType.value,ipAddress:this.deviceForm.controls.printerIpAddress.value},e.prev=1,e.next=4,this.actionService.order.print({orders:[],printer:t});case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),console.error(e.t0),this.utilService.openAlert({title:this.translate.instant("common.error"),body:this.translate.instant("setting.alert.print"),error:"{}"===JSON.stringify(e.t0)?e.t0:JSON.stringify(e.t0)});case 9:case"end":return e.stop()}}),e,this,[[1,6]])})))}},{key:"openDrawer",value:function(){return y(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={connectionType:this.deviceForm.controls.printerType.value,ipAddress:this.deviceForm.controls.printerIpAddress.value},e.prev=1,e.next=4,this.actionService.order.openDrawer({printer:t});case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),this.utilService.loadEnd(),console.error(e.t0),this.utilService.openAlert({title:this.translate.instant("common.error"),body:this.translate.instant("setting.alert.drawer"),error:"{}"===JSON.stringify(e.t0)?e.t0:JSON.stringify(e.t0)});case 9:case"end":return e.stop()}}),e,this,[[1,6]])})))}}])&&t(n.prototype,i),o&&t(n,o),r}();k.\u0275fac=function(e){return new(e||k)(h.Jc(l.b),h.Jc(d.f),h.Jc(d.a),h.Jc(d.d),h.Jc(f.d),h.Jc(c.b))},k.\u0275cmp=h.Dc({type:k,selectors:[["app-setting"]],decls:30,vars:28,consts:[[1,"contents-width","mx-auto","px-3","py-5"],[1,"mb-4"],[1,"text-large","mb-4","text-center","font-weight-bold"],[1,"mb-4","text-md-center",3,"innerHTML"],[1,"p-3","bg-white","mb-4"],[1,"font-weight-bold","mb-3"],[3,"theaters","data","valueChanges",4,"ngIf"],[3,"data","valueChanges","print","drawer",4,"ngIf"],[3,"profile","language","valueChanges",4,"ngIf"],[1,"buttons","mx-auto","text-center"],["type","submit",1,"btn","btn-primary","btn-block","py-3","mb-3",3,"disabled","click"],["type","button",1,"btn","btn-outline-primary","btn-block","py-3",3,"routerLink"],[3,"theaters","data","valueChanges"],[3,"data","valueChanges","print","drawer"],[3,"profile","language","valueChanges"]],template:function(e,t){1&e&&(h.Pc(0,"div",0),h.Pc(1,"div",1),h.Pc(2,"h2",2),h.zd(3),h.Zc(4,"translate"),h.Oc(),h.Kc(5,"p",3),h.Zc(6,"translate"),h.Pc(7,"div",4),h.Pc(8,"p",5),h.zd(9),h.Zc(10,"translate"),h.Oc(),h.xd(11,w,1,2,"app-input-app",6),h.Oc(),h.Pc(12,"div",4),h.Pc(13,"p",5),h.zd(14),h.Zc(15,"translate"),h.Oc(),h.xd(16,F,1,1,"app-input-device",7),h.Oc(),h.Pc(17,"div",4),h.Pc(18,"p",5),h.zd(19),h.Zc(20,"translate"),h.Oc(),h.xd(21,O,2,4,"app-input-customer",8),h.Oc(),h.Oc(),h.Pc(22,"div",9),h.Pc(23,"button",10),h.Wc("click",(function(){return t.onSubmit()})),h.Zc(24,"async"),h.zd(25),h.Zc(26,"translate"),h.Oc(),h.Pc(27,"button",11),h.zd(28),h.Zc(29,"translate"),h.Oc(),h.Oc(),h.Oc()),2&e&&(h.wc(3),h.Ad(h.ad(4,12,"setting.title")),h.wc(2),h.ed("innerHTML",h.ad(6,14,"setting.read"),h.sd),h.wc(4),h.Ad(h.ad(10,16,"setting.app.title")),h.wc(2),h.ed("ngIf",null==t.inputData?null:t.inputData.app),h.wc(3),h.Ad(h.ad(15,18,"setting.device.title")),h.wc(2),h.ed("ngIf",null==t.inputData?null:t.inputData.device),h.wc(3),h.Ad(h.ad(20,20,"setting.customer.title")),h.wc(2),h.ed("ngIf",t.inputData),h.wc(2),h.ed("disabled",h.ad(24,22,t.isLoading)),h.wc(2),h.Ad(h.ad(26,24,"setting.next")),h.wc(2),h.ed("routerLink",t.environment.BASE_URL),h.wc(1),h.Ad(h.ad(29,26,"setting.prev")))},directives:[o.l,c.c,m.a,g.a,b.a],pipes:[f.c,o.b],styles:[""]});var x=[{path:"",component:s.a,children:[{path:"",component:k}]}],A=function t(){e(this,t)};A.\u0275mod=h.Hc({type:A}),A.\u0275inj=h.Gc({factory:function(e){return new(e||A)},imports:[[c.d.forChild(x)],c.d]});var S=function t(){e(this,t)};S.\u0275mod=h.Hc({type:S}),S.\u0275inj=h.Gc({factory:function(e){return new(e||S)},imports:[[o.c,A,a.a]]})}}])}();