{"version":3,"sources":["app/canActivates/auth-guard.service.ts","app/canActivates/purchase-transaction-guard.service.ts","app/canActivates/setting-guard.service.ts","app/canActivates/view-type-guard.service.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * AuthGuardService\n */\nimport { Injectable } from '@angular/core';\nimport { CanActivate, Router } from '@angular/router';\nimport { CinerinoService } from '../services/cinerino.service';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class AuthGuardService implements CanActivate {\n\n    constructor(\n        private router: Router,\n        private cinerino: CinerinoService\n    ) { }\n\n    /**\n     * 認証\n     * @method canActivate\n     * @returns {Promise<boolean>}\n     */\n    public async canActivate(): Promise<boolean> {\n        try {\n            await this.cinerino.getServices();\n\n            return true;\n        } catch (error) {\n            console.log('canActivate', error);\n            this.router.navigate(['/']);\n\n            return false;\n        }\n    }\n}\n","/**\n * PurchaseTransactionGuardService\n */\nimport { Injectable } from '@angular/core';\nimport { CanActivate, Router } from '@angular/router';\nimport { PurchaseService } from '../services';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class PurchaseTransactionGuardService implements CanActivate {\n\n    constructor(\n        private router: Router,\n        private purchaseService: PurchaseService\n    ) { }\n\n    /**\n     * 認証\n     * @method canActivate\n     * @returns {Promise<boolean>}\n     */\n    public async canActivate(): Promise<boolean> {\n        try {\n            const transaction = (await this.purchaseService.getData()).transaction;\n            if (transaction === undefined) {\n                throw new Error('transaction not found').message;\n            }\n\n            return true;\n        } catch (error) {\n            console.log('canActivate', error);\n            this.router.navigate(['/']);\n\n            return false;\n        }\n    }\n}\n","/**\n * SettingGuardService\n */\nimport { Injectable } from '@angular/core';\nimport { CanActivate, Router } from '@angular/router';\nimport { select, Store } from '@ngrx/store';\nimport { Observable } from 'rxjs';\nimport * as reducers from '../store/reducers';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class SettingGuardService implements CanActivate {\n    public user: Observable<reducers.IUserState>;\n    constructor(\n        private router: Router,\n        private store: Store<reducers.IState>\n    ) { }\n\n    /**\n     * 認証\n     * @method canActivate\n     * @returns {Promise<boolean>}\n     */\n    public async canActivate(): Promise<boolean> {\n        try {\n            this.user = this.store.pipe(select(reducers.getUser));\n            const user = await this.getUser();\n            if (user.theater === undefined) {\n                throw new Error('theater not found').message;\n            }\n            if (user.customerContact === undefined) {\n                throw new Error('customerContact not found').message;\n            }\n\n            return true;\n        } catch (error) {\n            console.log('canActivate', error);\n            this.router.navigate(['/setting']);\n\n            return false;\n        }\n    }\n\n    private async getUser() {\n        return new Promise<reducers.IUserState>((resolve) => {\n            this.user.subscribe((user) => {\n                resolve(user);\n            }).unsubscribe();\n        });\n    }\n}\n","/**\n * ViewTypeGuardService\n */\nimport { Injectable } from '@angular/core';\nimport { ActivatedRouteSnapshot, CanActivate, Router, RouterStateSnapshot } from '@angular/router';\nimport { getEnvironment } from '../../environments/environment';\nimport { ViewType } from '../models';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class ViewTypeGuardService implements CanActivate {\n\n    constructor(\n        private router: Router\n    ) { }\n\n    /**\n     * 認証\n     * @method canActivate\n     * @returns {Promise<boolean>}\n     */\n    public async canActivate(_next: ActivatedRouteSnapshot, state: RouterStateSnapshot): Promise<boolean> {\n        try {\n            const viewType = getEnvironment().VIEW_TYPE;\n            if (state.url.match('/cinema') !== null && viewType !== ViewType.Cinema) {\n                throw new Error('viewType not match');\n            }\n\n            if (state.url.match('/event') !== null && viewType !== ViewType.Event) {\n                throw new Error('viewType not match');\n            }\n\n            return true;\n        } catch (error) {\n            console.error('canActivate', error);\n            this.router.navigate(['/error']);\n\n            return false;\n        }\n    }\n}\n"],"sourceRoot":"webpack:///","file":"default~modules-admission-admission-module~modules-auth-auth-module~modules-inquiry-inquiry-module~m~f17d069f-es5.js"}