<div class="contents-width mx-auto px-3 py-5">
    <h2 class="text-large mb-4 text-center font-weight-bold">{{ 'purchase.cinema.seat.title' | translate }}</h2>
    <p class="mb-4 text-md-center" [innerHTML]="'purchase.cinema.seat.read' | translate"></p>
    <div *ngIf="!(purchase | async).screen?.openSeatingAllowed" class="d-flex mb-3">
        <button type="button" class="btn btn-primary mr-2" [disabled]="isLoading | async"
            (click)="allSelectSeats()">{{ 'purchase.cinema.seat.allSelect' | translate }}</button>
        <button type="button" class="btn btn-outline-primary m-0"
            (click)="resetSeats()">{{ 'purchase.cinema.seat.reset' | translate }}</button>
    </div>

    <div class="row">
        <div class="col-lg-9">
            <app-screen *ngIf="(user | async).theater 
                && (purchase | async).screeningEventOffers.length > 0 
                && (purchase | async).screen" class="mb-4"
                [theaterCode]="(user | async).theater.branchCode"
                [screenCode]="(purchase | async).screen.branchCode"
                [screeningEventOffers]="(purchase | async).screeningEventOffers"
                [openSeatingAllowed]="(purchase | async).screen.openSeatingAllowed"
                [reservations]="(purchase | async).reservations"
                [authorizeSeatReservation]="(purchase | async).authorizeSeatReservation" (select)="selectSeat($event)">
            </app-screen>
            <div *ngIf="(purchase | async).screen?.openSeatingAllowed" class="mb-4">
                <div class="d-flex align-items-center">
                    <p class="mr-2">{{ 'purchase.cinema.seat.openSeating' | translate }}</p>
                    <select class="form-control d-inline-block w-auto" (change)="selectOpenSeating($event)"
                        [ngModel]="(purchase | async).reservations.length">
                        <option value="0">0</option>
                        <option
                            *ngFor="let value of remainingAttendeeCapacityValue((purchase | async).screeningEvent, (purchase | async).screeningEventOffers)"
                            [value]="value">{{ value }}</option>
                    </select>
                </div>
            </div>
        </div>
        <div class="col-lg-3">
            <app-purchase-info class="mb-4" [purchase]="purchase | async"></app-purchase-info>
        </div>
    </div>

    <div *ngIf="environment.PURCHASE_TERMS">
        <h2 class="text-large mb-4 text-center font-weight-bold">{{ 'purchase.cinema.seat.terms' | translate }}</h2>
        <div class="mb-4">
            <app-purchase-terms [language]="(user | async).language"
                [screeningEvent]="(purchase | async).screeningEvent"></app-purchase-terms>
        </div>
    </div>

    <div class="buttons mx-auto text-center">
        <button type="submit" class="btn btn-primary btn-block py-3 mb-3" [disabled]="isLoading | async"
            (click)="onSubmit()">{{ 'purchase.cinema.seat.next' | translate }}</button>
        <button type="button" class="btn btn-link"
            routerLink="/purchase/cinema/schedule">{{ 'purchase.cinema.seat.prev' | translate }}</button>
    </div>

</div>